syntax = "proto3";

package tickerbeats.v2;

option go_package = "ticker-beats/v2";

import "google/protobuf/empty.proto";
import "account.proto";
import "order.proto";
import "deal.proto";
import "position.proto";
import "tradetransaction.proto";


message PagedRequestOptions {
  // cursor can be passed to retrieve the next page of results keyed by the cursor
  int64  cursor = 1;
  // page_size specifies the number of items to return in the next page
  int64 page_size = 2;
}

message PagedResponseMetadata {
  // A cursor that can be provided to retrieve the next page of results
  int64  next_cursor = 1;
  // Whether or not more results exist
  bool has_more = 2;
}

// *******************
// Requests
// *******************
message AccountRequest {
    Account account = 1;
}

message OrderRequest {
  TradeRequest trade_request = 1;
}

message DealRequest {
  Deal deal = 1;
}

message PositionRequest {
  Position position = 1;
}

// *******************
// Services
// *******************

// AccountServiceClient is the client API for AccountService service.
service AccountServiceClient {
  // Creates a new account
  rpc CreateAccount (AccountRequest) returns (google.protobuf.Empty);
  // Gets an account by id
  rpc GetAccountById (AccountRequest) returns (Account);
}
 
// TradeServiceClient is the client API for TradeService service.
service TradeServiceClient {
  // Places a new order
  rpc PlaceOrder (OrderRequest) returns (TradeResult);
  // Modifies an existing order
  rpc ModifyOrder (OrderRequest) returns (TradeResult);
  // Cancels an existing order
  rpc CancelOrder (OrderRequest) returns (TradeResult);
  // Cancels all orders for an account
  rpc CancelAllOrders (OrderRequest) returns (TradeResult);
}

// OrderServiceClient is the client API for OrderService service.
service OrderServiceClient {
  // Gets an order by id
  rpc GetOrderById (OrderRequest) returns (Order);
  // Gets all orders for an account
  rpc GetOrdersByAccountId (OrderRequest) returns (stream Order);
  // Gets all orders for an account
  rpc GetOrdersBySymbol (OrderRequest) returns (stream Order);
  // Gets all orders with a status
  rpc GetOrdersByStatus (OrderRequest) returns (stream Order);
}

// DealServiceClient is the client API for DealService service.
service DealServiceClient {
  // Gets a deal by id
  rpc GetDealById (DealRequest) returns (Deal);
  // Gets all deals for an account
  rpc GetAllDeals (DealRequest) returns (stream Deal);
  // Gets deals by symbol for an account
  rpc GetDealsBySymbol (DealRequest) returns (stream Deal);
}

// PositionServiceClient is the client API for PositionService service.
service PositionServiceClient {
  // Gets a position by id
  rpc GetPositionById (PositionRequest) returns (Position);
  // Gets all positions
  rpc GetAllPositions (PositionRequest) returns (stream Position);
  // Gets a position by symbol
  rpc GetPositionsBySymbol (PositionRequest) returns (stream Position);
  // Close a position
  rpc ClosePosition (PositionRequest) returns (TradeResult);
  // Close all positions
  rpc CloseAllPosition (PositionRequest) returns (TradeResult);
  // Changes the TP and SL for a position
  rpc ModifyPosition (PositionRequest) returns (TradeResult);
}